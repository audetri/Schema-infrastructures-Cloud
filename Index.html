import React, { useState } from 'react';
import { Cloud, Database, Server, Shield, Users, Globe, HardDrive, Lock, Cpu, Network, Layers, GitBranch } from 'lucide-react';

export default function CloudInfrastructureDiagram() {
  const [config, setConfig] = useState({
    companyName: "Mon Entreprise",
    cloudProvider: "AWS",
    regions: ["EU-West-1", "EU-Central-1"],
    
    // Couches de l'infrastructure
    presentation: {
      enabled: true,
      components: ["Load Balancer", "CDN", "WAF"]
    },
    application: {
      enabled: true,
      components: ["API Gateway", "App Servers", "Microservices"]
    },
    data: {
      enabled: true,
      components: ["Database Primary", "Database Replica", "Cache", "Object Storage"]
    },
    security: {
      enabled: true,
      components: ["IAM", "Encryption", "VPN", "Monitoring"]
    },
    
    // Options
    showBackup: true,
    showDR: true,
    multiRegion: true,
    showNetwork: true
  });

  const cloudProviders = ["AWS", "Azure", "GCP", "Multi-Cloud"];
  
  const updateConfig = (path, value) => {
    setConfig(prev => {
      const newConfig = { ...prev };
      const keys = path.split('.');
      let current = newConfig;
      
      for (let i = 0; i < keys.length - 1; i++) {
        current = current[keys[i]];
      }
      current[keys[keys.length - 1]] = value;
      
      return newConfig;
    });
  };

  const toggleComponent = (layer, component) => {
    setConfig(prev => ({
      ...prev,
      [layer]: {
        ...prev[layer],
        components: prev[layer].components.includes(component)
          ? prev[layer].components.filter(c => c !== component)
          : [...prev[layer].components, component]
      }
    }));
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-8">
      <div className="max-w-7xl mx-auto">
        <div className="bg-white rounded-xl shadow-2xl overflow-hidden">
          
          {/* En-t√™te */}
          <div className="bg-gradient-to-r from-blue-600 to-indigo-700 p-6 text-white">
            <h1 className="text-3xl font-bold flex items-center gap-3">
              <Cloud className="w-8 h-8" />
              Sch√©ma d'Infrastructure Cloud
            </h1>
            <p className="mt-2 text-blue-100">√âditeur interactif pour votre architecture cloud</p>
          </div>

          {/* Panneau de configuration */}
          <div className="bg-gray-50 border-b border-gray-200 p-6">
            <h2 className="text-xl font-semibold mb-4 text-gray-800">Configuration</h2>
            
            <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
              {/* Nom de l'entreprise */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Nom de l'organisation
                </label>
                <input
                  type="text"
                  value={config.companyName}
                  onChange={(e) => updateConfig('companyName', e.target.value)}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                />
              </div>

              {/* Provider Cloud */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  Fournisseur Cloud
                </label>
                <select
                  value={config.cloudProvider}
                  onChange={(e) => updateConfig('cloudProvider', e.target.value)}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                >
                  {cloudProviders.map(provider => (
                    <option key={provider} value={provider}>{provider}</option>
                  ))}
                </select>
              </div>

              {/* R√©gions */}
              <div>
                <label className="block text-sm font-medium text-gray-700 mb-2">
                  R√©gion principale
                </label>
                <input
                  type="text"
                  value={config.regions[0]}
                  onChange={(e) => {
                    const newRegions = [...config.regions];
                    newRegions[0] = e.target.value;
                    updateConfig('regions', newRegions);
                  }}
                  className="w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                />
              </div>
            </div>

            {/* Options */}
            <div className="mt-6 flex flex-wrap gap-4">
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={config.showBackup}
                  onChange={(e) => updateConfig('showBackup', e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"
                />
                <span className="text-sm text-gray-700">Afficher la sauvegarde</span>
              </label>
              
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={config.showDR}
                  onChange={(e) => updateConfig('showDR', e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"
                />
                <span className="text-sm text-gray-700">Plan de reprise (DR)</span>
              </label>
              
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={config.multiRegion}
                  onChange={(e) => updateConfig('multiRegion', e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"
                />
                <span className="text-sm text-gray-700">Multi-r√©gion</span>
              </label>
              
              <label className="flex items-center gap-2 cursor-pointer">
                <input
                  type="checkbox"
                  checked={config.showNetwork}
                  onChange={(e) => updateConfig('showNetwork', e.target.checked)}
                  className="w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"
                />
                <span className="text-sm text-gray-700">D√©tails r√©seau</span>
              </label>
            </div>
          </div>

          {/* Sch√©ma d'infrastructure */}
          <div className="p-8 bg-gradient-to-br from-slate-50 to-blue-50">
            
            {/* Titre du sch√©ma */}
            <div className="text-center mb-8">
              <h2 className="text-2xl font-bold text-gray-800">{config.companyName}</h2>
              <p className="text-gray-600">Architecture Cloud - {config.cloudProvider}</p>
              <p className="text-sm text-gray-500">{config.regions[0]}</p>
            </div>

            {/* Internet / Utilisateurs */}
            <div className="mb-8 text-center">
              <div className="inline-flex items-center gap-3 bg-green-100 border-2 border-green-400 rounded-lg px-6 py-3">
                <Users className="w-6 h-6 text-green-700" />
                <span className="font-semibold text-green-900">Utilisateurs / Internet</span>
                <Globe className="w-6 h-6 text-green-700" />
              </div>
            </div>

            {/* Fl√®che vers bas */}
            <div className="flex justify-center mb-6">
              <div className="w-1 h-8 bg-gray-400"></div>
            </div>

            {/* Couche S√©curit√© P√©rim√©trique */}
            {config.security.enabled && (
              <>
                <div className="bg-red-50 border-2 border-red-300 rounded-xl p-6 mb-6">
                  <div className="flex items-center gap-3 mb-4">
                    <Shield className="w-6 h-6 text-red-600" />
                    <h3 className="text-lg font-bold text-red-900">Couche S√©curit√©</h3>
                  </div>
                  <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                    {['WAF', 'DDoS Protection', 'IAM', 'VPN'].map(comp => (
                      <div key={comp} className="bg-white rounded-lg p-3 border border-red-200 text-center">
                        <Lock className="w-5 h-5 text-red-600 mx-auto mb-1" />
                        <span className="text-sm font-medium text-gray-700">{comp}</span>
                      </div>
                    ))}
                  </div>
                </div>
                <div className="flex justify-center mb-6">
                  <div className="w-1 h-8 bg-gray-400"></div>
                </div>
              </>
            )}

            {/* Couche Pr√©sentation */}
            {config.presentation.enabled && (
              <>
                <div className="bg-blue-50 border-2 border-blue-300 rounded-xl p-6 mb-6">
                  <div className="flex items-center gap-3 mb-4">
                    <Globe className="w-6 h-6 text-blue-600" />
                    <h3 className="text-lg font-bold text-blue-900">Couche Pr√©sentation</h3>
                  </div>
                  <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                    {config.presentation.components.map(comp => (
                      <div key={comp} className="bg-white rounded-lg p-4 border border-blue-200">
                        <Network className="w-5 h-5 text-blue-600 mb-2" />
                        <span className="text-sm font-semibold text-gray-700">{comp}</span>
                      </div>
                    ))}
                  </div>
                </div>
                <div className="flex justify-center mb-6">
                  <div className="w-1 h-8 bg-gray-400"></div>
                </div>
              </>
            )}

            {/* R√©seau virtuel */}
            {config.showNetwork && (
              <div className="bg-purple-50 border-2 border-purple-300 rounded-xl p-4 mb-6">
                <div className="flex items-center gap-2 justify-center">
                  <Network className="w-5 h-5 text-purple-600" />
                  <span className="font-semibold text-purple-900">VPC / Virtual Network</span>
                </div>
              </div>
            )}

            <div className="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
              
              {/* Couche Application */}
              {config.application.enabled && (
                <div className="bg-indigo-50 border-2 border-indigo-300 rounded-xl p-6">
                  <div className="flex items-center gap-3 mb-4">
                    <Server className="w-6 h-6 text-indigo-600" />
                    <h3 className="text-lg font-bold text-indigo-900">Couche Application</h3>
                  </div>
                  <div className="space-y-3">
                    {config.application.components.map(comp => (
                      <div key={comp} className="bg-white rounded-lg p-3 border border-indigo-200 flex items-center gap-3">
                        <Cpu className="w-5 h-5 text-indigo-600" />
                        <span className="text-sm font-medium text-gray-700">{comp}</span>
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {/* Couche Donn√©es */}
              {config.data.enabled && (
                <div className="bg-emerald-50 border-2 border-emerald-300 rounded-xl p-6">
                  <div className="flex items-center gap-3 mb-4">
                    <Database className="w-6 h-6 text-emerald-600" />
                    <h3 className="text-lg font-bold text-emerald-900">Couche Donn√©es</h3>
                  </div>
                  <div className="space-y-3">
                    {config.data.components.map(comp => (
                      <div key={comp} className="bg-white rounded-lg p-3 border border-emerald-200 flex items-center gap-3">
                        {comp.includes('Database') && <Database className="w-5 h-5 text-emerald-600" />}
                        {comp === 'Cache' && <Layers className="w-5 h-5 text-emerald-600" />}
                        {comp.includes('Storage') && <HardDrive className="w-5 h-5 text-emerald-600" />}
                        <span className="text-sm font-medium text-gray-700">{comp}</span>
                      </div>
                    ))}
                  </div>
                </div>
              )}
            </div>

            {/* Options suppl√©mentaires */}
            <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
              
              {/* Backup */}
              {config.showBackup && (
                <div className="bg-amber-50 border-2 border-amber-300 rounded-xl p-4">
                  <div className="flex items-center gap-3">
                    <HardDrive className="w-6 h-6 text-amber-600" />
                    <div>
                      <h4 className="font-bold text-amber-900">Sauvegarde</h4>
                      <p className="text-sm text-amber-700">Snapshots automatiques quotidiens</p>
                    </div>
                  </div>
                </div>
              )}

              {/* DR Site */}
              {config.showDR && config.multiRegion && (
                <div className="bg-orange-50 border-2 border-orange-300 rounded-xl p-4">
                  <div className="flex items-center gap-3">
                    <GitBranch className="w-6 h-6 text-orange-600" />
                    <div>
                      <h4 className="font-bold text-orange-900">Site de Reprise (DR)</h4>
                      <p className="text-sm text-orange-700">{config.regions[1] || 'R√©gion secondaire'}</p>
                    </div>
                  </div>
                </div>
              )}
            </div>

            {/* Monitoring */}
            <div className="mt-6 bg-slate-100 border-2 border-slate-300 rounded-xl p-4">
              <div className="flex items-center gap-3 justify-center">
                <Cpu className="w-5 h-5 text-slate-600" />
                <span className="font-semibold text-slate-900">Monitoring & Logging centralis√©</span>
              </div>
            </div>
          </div>

          {/* L√©gende */}
          <div className="bg-gray-100 p-6 border-t border-gray-200">
            <h3 className="font-semibold text-gray-800 mb-3">L√©gende</h3>
            <div className="grid grid-cols-2 md:grid-cols-4 gap-4 text-sm">
              <div className="flex items-center gap-2">
                <div className="w-4 h-4 bg-red-200 border border-red-400 rounded"></div>
                <span className="text-gray-700">S√©curit√©</span>
              </div>
              <div className="flex items-center gap-2">
                <div className="w-4 h-4 bg-blue-200 border border-blue-400 rounded"></div>
                <span className="text-gray-700">Pr√©sentation</span>
              </div>
              <div className="flex items-center gap-2">
                <div className="w-4 h-4 bg-indigo-200 border border-indigo-400 rounded"></div>
                <span className="text-gray-700">Application</span>
              </div>
              <div className="flex items-center gap-2">
                <div className="w-4 h-4 bg-emerald-200 border border-emerald-400 rounded"></div>
                <span className="text-gray-700">Donn√©es</span>
              </div>
            </div>
          </div>

          {/* Instructions */}
          <div className="bg-blue-50 border-t border-blue-200 p-6">
            <h3 className="font-semibold text-blue-900 mb-2 flex items-center gap-2">
              <span>üí°</span> Instructions d'utilisation
            </h3>
            <ul className="text-sm text-blue-800 space-y-1">
              <li>‚Ä¢ Modifiez le nom de votre organisation et les param√®tres dans la section Configuration</li>
              <li>‚Ä¢ Activez ou d√©sactivez les options (sauvegarde, DR, multi-r√©gion) selon vos besoins</li>
              <li>‚Ä¢ Le sch√©ma se met √† jour automatiquement en temps r√©el</li>
              <li>‚Ä¢ Utilisez la capture d'√©cran pour exporter votre sch√©ma</li>
            </ul>
          </div>
        </div>
      </div>
    </div>
  );
}
}